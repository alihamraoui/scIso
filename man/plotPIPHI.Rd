% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plotPIPHI.R
\name{plotPIPHI}
\alias{plotPIPHI}
\title{Plot mean PI vs Phi for isoforms}
\usage{
plotPIPHI(pi_mat, iso_mat, pi_min = 0.3, pi_max = 0.7, min_gene_count = 1000)
}
\arguments{
\item{pi_mat}{A numeric or sparse matrix of PI values (isoforms Ã— cells).}

\item{iso_mat}{A numeric or sparse matrix of isoform-level counts
(same dimensions and rownames as \code{pi_mat}), used to derive gene-level
coverage.}

\item{pi_min}{Minimum mean PI threshold to retain isoforms (default: 0.3).}

\item{pi_max}{Maximum mean PI threshold to retain isoforms (default: 0.7).}

\item{min_gene_count}{Minimum total gene count required to include an isoform
in the plot (default: 3500).}
}
\value{
A \code{ggplot} object visualizing mean PI vs Phi, colored by
gene-level count.
}
\description{
This function summarizes isoform-level PI values and visualizes the relationship
between mean PI and Phi across isoforms. Isoforms can be filtered based on
their mean PI and total gene-level support before plotting.
}
\details{
For each isoform, the function computes:
\itemize{
\item mean PI across cells;
\item Phi using \code{\link{computePHI}} (inter-cell variability);
\item number of cells with non-zero counts;
\item total gene-level count (sum across all isoforms of a gene).
}

Isoforms are filtered according to \code{pi_min}, \code{pi_max}, and
\code{min_gene_count}, and only those passing all filters are plotted.
}
\examples{
\dontrun{
set.seed(123)
pi_mat <- matrix(runif(200, 0.05, 0.95), nrow = 50,
                 dimnames = list(paste0("Gene", rep(1:10, each = 5), "..Tx", 1:5),
                                 paste0("Cell", 1:4)))
iso_mat <- matrix(sample(0:20, 200, replace = TRUE), nrow = 50,
                  dimnames = dimnames(pi_mat))

# Default thresholds
plotPIPHI(pi_mat, iso_mat)

# Custom thresholds
plotPIPHI(pi_mat, iso_mat, pi_min = 0.2, pi_max = 0.8, min_gene_count = 10)
}

}
