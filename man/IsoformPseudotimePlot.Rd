% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/IsoformPseudotimePlot.R
\name{IsoformPseudotimePlot}
\alias{IsoformPseudotimePlot}
\title{Plot isoform PI or expression along pseudotime with annotation bands}
\usage{
IsoformPseudotimePlot(
  seurat_obj,
  gene,
  pseudotime_col,
  band_cols = "cell_type",
  assay = "ISO",
  slot = "counts",
  mode = c("PI", "exp"),
  delimiter = "\\\\.\\\\.",
  nbins = 100
)
}
\arguments{
\item{seurat_obj}{A Seurat object.}

\item{gene}{Character scalar. Gene name used as prefix for isoform IDs
(e.g. "GeneA" for rows like "GeneA..Tx1").}

\item{pseudotime_col}{Name of the metadata column containing pseudotime values.}

\item{band_cols}{Character vector of metadata column names to display as
annotation bands (e.g. \code{c("cell_type", "Phase")}). Each should be
a categorical variable.}

\item{assay}{Assay name containing isoform-level counts. Default: \code{"ISO"}.}

\item{slot}{Slot of the assay to use (e.g. \code{"counts"}, \code{"data"}).
Default: \code{"counts"}.}

\item{mode}{Either \code{"PI"} (default) to plot isoform Percent Inclusion
(per-cell proportions across isoforms of the gene) or \code{"exp"} to plot
raw isoform expression.}

\item{delimiter}{Regex delimiter between gene and isoform ID.
Default: \code{"\\\\.\\\\."}.}

\item{nbins}{Integer. Number of bins along pseudotime for aggregating
annotation bands. Default: 100.}
}
\value{
A \code{patchwork} object combining the annotation band plot(s)
and the isoform trend plot.
}
\description{
Visualizes isoform-level usage or expression for a given gene along pseudotime,
together with one or multiple categorical annotations displayed as horizontal
bands (e.g. cell type, cell cycle phase). The two most abundant isoforms of
the gene are shown.
}
\examples{
\dontrun{
library(Seurat)
library(Matrix)

set.seed(123)

iso_names <- c("GeneA..Tx1", "GeneA..Tx2", "GeneA..Tx3")
mat <- Matrix(
  rpois(300, lambda = 10),
  nrow = 3,
  sparse = TRUE,
  dimnames = list(iso_names, paste0("Cell", 1:100))
)

obj <- CreateSeuratObject(counts = mat, assay = "ISO")
obj$pseudotime <- sort(runif(100, 0, 1))
obj$cell_type  <- sample(c("Tumor", "Stromal", "Immune"), 100, TRUE)
obj$Phase      <- sample(c("G1", "S", "G2M"), 100, TRUE)

IsoformPseudotimePlot(
  seurat_obj     = obj,
  gene           = "GeneA",
  pseudotime_col = "pseudotime",
  band_cols      = c("cell_type", "Phase"),
  assay          = "ISO",
  mode           = "PI"
)
}

}
