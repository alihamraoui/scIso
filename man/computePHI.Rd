% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/computePHI.R
\name{computePHI}
\alias{computePHI}
\title{Compute Phi (ϕ) from a PI matrix}
\usage{
computePHI(pi_mat)
}
\arguments{
\item{pi_mat}{A numeric or sparse matrix of PI values (isoforms × cells).}
}
\value{
A named numeric vector of \eqn{\phi} values, one per isoform (row of
\code{pi_mat}). Rows with insufficient data or invalid parameters return
\code{NA}.
}
\description{
This function estimates the dispersion parameter \eqn{\phi} of a Beta
distribution for each isoform (row) in a matrix of PI (Percent Inclusion)
values. The parameter \eqn{\phi} reflects the intercellular variability of
isoform usage across cells.
}
\details{
For each isoform, \eqn{\phi} is estimated from the sample mean (\eqn{m}) and
variance (\eqn{v}) of PI values across cells, using the method of moments:
\deqn{\phi = 1 / (\alpha + \beta + 1)}
where \eqn{\alpha = m((1 - m)/v - 1)} and \eqn{\beta = (1 - m)((1 - m)/v - 1)}.

Isoforms with fewer than three valid observations or with degenerate mean or
variance values return \code{NA}.
}
\examples{
set.seed(123)
pi_mat <- matrix(runif(20, 0.1, 0.9), nrow = 5,
                 dimnames = list(paste0("Iso", 1:5), paste0("Cell", 1:4)))
phi_vec <- computePHI(pi_mat)
phi_vec

}
