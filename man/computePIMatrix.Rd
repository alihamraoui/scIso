% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/computePIMatrix.R
\name{computePIMatrix}
\alias{computePIMatrix}
\title{Compute PI (Percent Isoform) Matrix from Isoform Counts}
\usage{
computePIMatrix(seurat_obj, assay = "ISO", slot = "counts")
}
\arguments{
\item{seurat_obj}{A Seurat object containing isoform-level counts in one assay.}

\item{assay}{Character string specifying the assay that contains isoform counts.
Default is \code{"ISO"}.}

\item{slot}{Character string indicating which slot of the assay to use
(e.g., \code{"counts"} or \code{"data"}). Default is \code{"counts"}.}
}
\value{
A matrix of PI values (isoforms Ã— cells) with \code{NA} where
total gene counts are zero.
}
\description{
This function calculates per-cell isoform usage (PI) values from an isoform-level
count matrix stored in a Seurat object. For each gene, isoform counts are divided
by the total counts of all isoforms belonging to that gene within each cell.
}
\details{
The function expects rownames in the form \code{GeneName..TranscriptID}. The part
before the first double dot (\code{..}) is interpreted as the gene identifier.
PI values are computed per isoform and per cell as:
\deqn{PSI = count(isoform) / sum(counts of all isoforms from the same gene)}

Cells with zero total counts for a given gene return \code{NA} PI values for its isoforms.
}
\examples{
library(Seurat)
iso_names <- c("G1..Tx1", "G1..Tx2", "G2..Tx1", "G2..Tx2")
counts <- matrix(c(10, 5, 3, 7, 0, 4, 2, 6),
                 nrow = 4,
                 dimnames = list(iso_names, paste0("Cell", 1:2)))
seurat_obj <- CreateSeuratObject(counts = counts, assay = "ISO")

pi <- computePIMatrix(seurat_obj)
head(pi)

}
