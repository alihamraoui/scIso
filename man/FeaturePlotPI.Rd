% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FeaturePlotPI.R
\name{FeaturePlotPI}
\alias{FeaturePlotPI}
\title{Visualize isoform PI, ratios and distributions on embeddings}
\usage{
FeaturePlotPI(
  obj,
  iso1,
  iso2,
  reduction,
  assay = "ISO",
  slot = "counts",
  name = NULL,
  add_ratio = TRUE,
  min_total = 0,
  col = "PI",
  bins = 30
)
}
\arguments{
\item{obj}{A Seurat object.}

\item{iso1}{Isoform ID for the first isoform (must be a row name in the assay).}

\item{iso2}{Isoform ID for the second isoform (must be a row name in the assay).}

\item{reduction}{Character string giving the name of the dimensional reduction}

\item{assay}{Assay name containing isoform counts. Default: "ISO".}

\item{slot}{Slot to use in the assay (e.g. "counts", "data"). Default: "counts".}

\item{name}{Optional base name used to construct metadata column names.}

\item{add_ratio}{Logical; if TRUE, add ratio and log2ratio to metadata. Default: TRUE.}

\item{min_total}{Numeric threshold: cells with iso1 + iso2 < min_total
are set to NA for PI. Default: 0.}

\item{col}{Suffix used for PI-based metadata/label naming. Default: "PI".}

\item{bins}{Number of bins for the PI histogram. Default: 30.}
}
\value{
A combined plot (patchwork) with three feature plots and one histogram.
}
\description{
This function visualizes the relative usage (PI, Percent Inclusion) of two
isoforms across cells on a low-dimensional embedding stored in a Seurat object.
It computes per-cell PI for each isoform, their ratio and log2-ratio, ajoute
ces valeurs dans les meta.data, puis affiche :
\itemize{
\item PI de l'isoforme 1 sur l'embedding,
\item PI de l'isoforme 2 sur l'embedding,
\item log2(ratio iso1 / iso2) sur l'embedding,
\item histogramme de la distribution de PI pour l'isoforme 1.
}
}
\examples{
\dontrun{
library(Seurat)
library(Matrix)

set.seed(42)

# Build sparse count matrix
mat <- Matrix(
  rpois(200, lambda = 10),
  nrow = 2,
  sparse = TRUE,
  dimnames = list(
    c("GeneA..Tx1", "GeneA..Tx2"),
    paste0("Cell", 1:100)
  )
)

# Create Seurat object with assay = "ISO"
obj <- CreateSeuratObject(counts = mat, assay = "ISO")

# Add UMAP reduction linked to ISO assay
emb <- matrix(
  rnorm(200),
  ncol = 2,
  dimnames = list(colnames(obj), c("UMAP_1", "UMAP_2"))
)
obj[["umap"]] <- CreateDimReducObject(
  embeddings = emb,
  key = "UMAP_",
  assay = "ISO"
)

# Visualize isoform PI
FeaturePlotPI(obj, "GeneA..Tx1", "GeneA..Tx2", name2D = "umap")
}
}
