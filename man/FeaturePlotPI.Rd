% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/FeaturePlotPI.R
\name{FeaturePlotPI}
\alias{FeaturePlotPI}
\title{Visualize isoform percent inclusion (PI), ratios and distributions on embeddings}
\usage{
FeaturePlotPI(
  obj,
  iso1,
  iso2,
  reduction,
  assay = "ISO",
  slot = "counts",
  name = NULL,
  add_ratio = TRUE,
  min_total = 0,
  col = "PI",
  bins = 30
)
}
\arguments{
\item{obj}{A Seurat object.}

\item{iso1}{Isoform ID for the first isoform (must be a row name in the assay).}

\item{iso2}{Isoform ID for the second isoform (must be a row name in the assay).}

\item{reduction}{Name of the dimensional reduction to use (e.g. \code{"umap"}).}

\item{assay}{Assay name containing isoform counts. Default: \code{"ISO"}.}

\item{slot}{Slot to use in the assay (e.g. \code{"counts"}, \code{"data"}).
Default: \code{"counts"}.}

\item{name}{Optional base name used to construct metadata column names.}

\item{add_ratio}{Logical; if \code{TRUE}, add ratio and log2-ratio to metadata.
Default: \code{TRUE}.}

\item{min_total}{Numeric threshold: cells with \code{iso1 + iso2 < min_total}
are set to \code{NA} for PI. Default: \code{0}.}

\item{col}{Suffix used for PI-based metadata/label naming. Default: \code{"PI"}.}

\item{bins}{Number of bins for the PI histogram. Default: \code{30}.}
}
\value{
A \code{patchwork} object combining three feature plots and one histogram.
}
\description{
This function visualizes the relative usage (PI, Percent Inclusion) of two
isoforms across cells on a low-dimensional embedding stored in a Seurat object.
It computes per-cell PI for each isoform, their ratio and log2-ratio, adds
these values to the object metadata, and displays:
}
\details{
\itemize{
\item PI of isoform 1 on the embedding,
\item PI of isoform 2 on the embedding,
\item log2(ratio iso1 / iso2) on the embedding,
\item histogram of the PI distribution for isoform 1.
}
}
\examples{
\dontrun{
library(Seurat)
library(Matrix)

set.seed(42)

mat <- Matrix(
  rpois(200, lambda = 10),
  nrow = 2,
  sparse = TRUE,
  dimnames = list(
    c("GeneA..Tx1", "GeneA..Tx2"),
    paste0("Cell", 1:100)
  )
)

obj <- CreateSeuratObject(counts = mat, assay = "ISO")

emb <- matrix(
  rnorm(200),
  ncol = 2,
  dimnames = list(colnames(obj), c("UMAP_1", "UMAP_2"))
)

obj[["umap"]] <- CreateDimReducObject(
  embeddings = emb,
  key = "UMAP_",
  assay = "ISO"
)

FeaturePlotPI(obj, "GeneA..Tx1", "GeneA..Tx2", reduction = "umap")
}

}
